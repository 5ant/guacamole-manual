<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="configuring-guacamole" 
    xmlns="http://docbook.org/ns/docbook" version="5.0" xml:lang="en"
    xmlns:xi="http://www.w3.org/2001/XInclude">

    <title>Configuring Guacamole</title>

    <!--
    - Initial setup
    -->

    <section xml:id="initial-setup">
        <title>Initial setup</title>
        <indexterm xmlns:xl="http://www.w3.org/1999/xlink">
            <primary>guacamole.properties</primary>
        </indexterm>
        <indexterm xmlns:xl="http://www.w3.org/1999/xlink">
            <primary>configuration</primary>
            <secondary>Guacamole</secondary>
        </indexterm>
        <indexterm xmlns:xl="http://www.w3.org/1999/xlink">
            <primary>Guacamole</primary>
            <secondary>configuring</secondary>
        </indexterm>
        <para>The Guacamole web application uses one main configuration file
            called <filename>guacamole.properties</filename> which must be in
            the classpath of your servlet container. This file is the common
            location for all configuration properties read by Guacamole or any
            extension of Guacamole, including authentication providers. </para>
        <para>At the bare minimum, the <filename>guacamole.properties</filename>
            file provides four basic properties: </para>
        <variablelist>
            <varlistentry>
                <term><indexterm xmlns:xl="http://www.w3.org/1999/xlink">
                        <primary>guacd-host</primary>
                    </indexterm><parameter>guacd-host</parameter></term>
                <listitem>
                    <para>The host the Guacamole proxy daemon (guacd) is
                        listening on. This is most likely localhost. </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><indexterm xmlns:xl="http://www.w3.org/1999/xlink">
                        <primary>guacd-port</primary>
                    </indexterm><parameter>guacd-port</parameter></term>
                <listitem>
                    <para>The port the Guacamole proxy daemon (guacd) is
                        listening on. This is port 4822 by default. </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><indexterm xmlns:xl="http://www.w3.org/1999/xlink">
                        <primary>auth-provider</primary>
                    </indexterm><parameter>auth-provider</parameter></term>
                <listitem>
                    <para>The authentication provider to use when
                        authenticating. Normally, this will be set to
                            <classname>BasicFileAuthenticationProvider</classname>
                        which is the default authentication provider provided
                        with Guacamole. </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term><indexterm xmlns:xl="http://www.w3.org/1999/xlink">
                        <primary>lib-directory</primary>
                    </indexterm><parameter>lib-directory</parameter></term>
                <listitem>
                    <para>The directory to load extensions to Guacamole from. If
                        you wish to use a custom authentication provider or
                        custom hooks, the .jar file and all dependencies must be
                        placed in the directory specified here. </para>
                </listitem>
            </varlistentry>
        </variablelist>
        <example>
            <title>Minimal <filename>guacamole.properties</filename></title>
            <xi:include href="conf/guacamole.properties.xml"/>
        </example>
    </section>

    <!--
    - Authentication
    -->

    <section xml:id="authentication-setup">
        <title>Authentication</title>
        <indexterm xmlns:xl="http://www.w3.org/1999/xlink">
            <primary>user-mapping.xml</primary>
        </indexterm>
        <indexterm xmlns:xl="http://www.w3.org/1999/xlink">
            <primary>authentication</primary>
        </indexterm>
        <para>Guacamole's authentication model is simple and consists of a
            mapping of usernames to configurations. Each username has a
            corresponding password and associated set of configurations, and
            each configuration has a protocol and protocol-specific set of
            parameters. The example <filename>user-mapping.xml</filename> file
            included with Guacamole is a fairly good example of this concept. </para>
        <para>Authentication is configured by editing guacamole.properties and
            setting the authentication provider property:
                <property>auth-provider</property>. </para>
        <para>Guacamole comes with an authentication provider,
                <classname>BasicFileAuthenticationProvider</classname>, which
            simply reads usernames and passwords from an XML file. </para>
    </section>

    <!--
    - Adding users and connections
    -->

    <section xml:id="connection-setup">
        <title>Adding users and connections</title>
        <indexterm xmlns:xl="http://www.w3.org/1999/xlink">
            <primary>users</primary>
            <secondary>adding</secondary>
        </indexterm>
        <indexterm xmlns:xl="http://www.w3.org/1999/xlink">
            <primary>connections</primary>
            <secondary>adding</secondary>
        </indexterm>
        <para>The default authentication provider used by Guacamole reads all
            username, password, and configuration information from a file called
            the "user mapping" (typically named
                <filename>user-mapping.xml</filename>). Other authentication
            providers can be written which read authentication information from
            other sources, but those are not documented here. To learn how to
            configure an authentication provider not included in the main
            Guacamole bundle, consult the documentation provided with that
            authentication provider. </para>
        <example>
            <title>A simple <filename>user-mapping.xml</filename></title>
            <xi:include href="conf/user-mapping.xml.xml"/>
        </example>
    </section>

</chapter>
